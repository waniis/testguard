(function(e){function t(t){for(var o,l,r=t[0],s=t[1],u=t[2],d=0,v=[];d<r.length;d++)l=r[d],i[l]&&v.push(i[l][0]),i[l]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);c&&c(t);while(v.length)v.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,r=1;r<n.length;r++){var s=n[r];0!==i[s]&&(o=!1)}o&&(a.splice(t--,1),e=l(l.s=n[0]))}return e}var o={},i={app:0},a=[];function l(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var u=0;u<r.length;u++)t(r[u]);var c=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"1d6c":function(e,t,n){"use strict";var o=n("b4f8"),i=n.n(o);i.a},"5c0b":function(e,t,n){"use strict";var o=n("5e27"),i=n.n(o);i.a},"5e27":function(e,t,n){},b4f8:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"udesly-rules-configuration"}},[e._l(e.values,function(t,o){return n("AutoComplete",{key:o,attrs:{enabled:e.enabledAdd,combination:e.combinations[o]||"",predicate:e.predicate,first:o!==e.values.length-1||0==o,subjects:e.subjects},on:{remove:function(t){return e.handleRemove(o)},and:function(t){return e.handleAnd(o)},or:function(t){return e.handleOr(o)},"validity-change":function(t){return e.handleValidityChange(o,t)}},model:{value:e.values[o],callback:function(t){e.$set(e.values,o,t)},expression:"values[index]"}})}),n("div",{staticClass:"udesly-actions",staticStyle:{"text-align":"right","margin-top":"150px"}},[n("button",{staticClass:"udesly-button",attrs:{disabled:!e.isValid()},on:{click:function(t){return t.preventDefault(),e.save(t)}}},[e._v(e._s(e.buttonLabel))])])],2)},a=[],l=n("f499"),r=n.n(l),s=n("db0c"),u=n.n(s),c=(n("6762"),n("2fdb"),n("a481"),n("5d73")),d=n.n(c),v=(n("ac6a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"udesly-completely-wrapper"},[n("div",{class:{valid:e.valid},attrs:{"udesly-completely":""}}),e.enabled?n("div",{staticClass:"udesly-button",class:{selected:"and"==e.combination},on:{click:function(t){return e.$emit("and")}}},[e._v("AND")]):e._e(),e.enabled?n("div",{staticClass:"udesly-button",class:{selected:"or"==e.combination},on:{click:function(t){return e.$emit("or")}}},[e._v("OR")]):e._e(),e.first?e._e():n("i",{staticClass:"fas fa-trash",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$emit("remove")}}})])}),p=[],f=n("75fc");function h(e,t){t=t||{},t.fontSize=t.fontSize||"16px",t.fontFamily=t.fontFamily||"sans-serif",t.promptInnerHTML=t.promptInnerHTML||"",t.color=t.color||"#333",t.hintColor=t.hintColor||"#aaa",t.backgroundColor=t.backgroundColor||"#fff",t.dropDownBorderColor=t.dropDownBorderColor||"#aaa",t.dropDownZIndex=t.dropDownZIndex||"100",t.dropDownOnHoverBackgroundColor=t.dropDownOnHoverBackgroundColor||"#ddd";var n=document.createElement("input");n.type="text",n.spellcheck=!1,n.style.fontSize=t.fontSize,n.style.fontFamily=t.fontFamily,n.style.color=t.color,n.style.backgroundColor=t.backgroundColor,n.style.width="100%",n.style.outline="0",n.style.border="0",n.style.margin="0",n.style.padding="0";var o=n.cloneNode();o.disabled="",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.borderColor="transparent",o.style.boxShadow="none",o.style.color=t.hintColor,n.style.backgroundColor="transparent",n.style.verticalAlign="top",n.style.position="relative";var i=document.createElement("div");i.style.position="relative",i.style.outline="0",i.style.border="0",i.style.margin="0",i.style.padding="0";var a=document.createElement("div");if(a.style.position="absolute",a.style.outline="0",a.style.margin="0",a.style.padding="0",a.style.border="0",a.style.fontSize=t.fontSize,a.style.fontFamily=t.fontFamily,a.style.color=t.color,a.style.backgroundColor=t.backgroundColor,a.style.top="0",a.style.left="0",a.style.overflow="hidden",a.innerHTML=t.promptInnerHTML,a.style.background="transparent",void 0===document.body)throw"document.body is undefined. The library was wired up incorrectly.";document.body.appendChild(a);var l=a.getBoundingClientRect().right;i.appendChild(a),a.style.visibility="visible",a.style.left="-"+l+"px",i.style.marginLeft=l+"px",i.appendChild(o),i.appendChild(n);var r=document.createElement("div");r.classList.add("udesly-dropdown-autocomplete"),r.style.position="absolute",r.style.visibility="hidden",r.style.outline="0",r.style.margin="0",r.style.textAlign="left",r.style.zIndex=t.dropDownZIndex,r.style.cursor="default",r.style.borderStyle="solid",r.style.overflowX="hidden",r.style.whiteSpace="pre",r.style.overflowY="auto";var s,u,c=function(e){var n=[],o=0,i=-1,a=function(){},l=function(){},r=function(){s.hide(),s.onmouseselection(this.__hint)},s={hide:function(){e.style.visibility="hidden"},refresh:function(i,u){e.style.visibility="hidden",o=0,e.innerHTML="";var c=window.innerHeight||document.documentElement.clientHeight,d=e.parentNode.getBoundingClientRect(),v=d.top-6,p=c-d.bottom-6;n=[];for(var f=0;f<u.length;f++)if(0===u[f].indexOf(i)){var h=document.createElement("div");h.style.color=t.color,h.onmouseover=a,h.onmouseout=l,h.onmousedown=r,h.__hint=u[f],h.innerHTML=i+"<span>"+u[f].substring(i.length)+"</span>",n.push(h),e.appendChild(h)}0!==n.length&&(1===n.length&&i===n[0].__hint||n.length<2||(s.highlight(0),v>3*p?(e.style.maxHeight=v+"px",e.style.top="",e.style.bottom="100%"):(e.style.top="100%",e.style.bottom="",e.style.maxHeight=p+"px"),e.style.visibility="visible"))},highlight:function(e){-1!=i&&n[i]&&(n[i].style.backgroundColor=t.backgroundColor),n[e].style.backgroundColor=t.dropDownOnHoverBackgroundColor,i=e},move:function(t){return"hidden"===e.style.visibility?"":o+t===-1||o+t===n.length?n[o].__hint:(o+=t,s.highlight(o),n[o].__hint)},onmouseselection:function(){}};return s},d=c(r);function v(e){return void 0===s&&(s=document.createElement("span"),s.style.visibility="hidden",s.style.position="fixed",s.style.outline="0",s.style.margin="0",s.style.padding="0",s.style.border="0",s.style.left="0",s.style.whiteSpace="pre",s.style.fontSize=t.fontSize,s.style.fontFamily=t.fontFamily,s.style.fontWeight="normal",document.body.appendChild(s)),s.innerHTML=String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s.getBoundingClientRect().right}d.onmouseselection=function(e){n.value=o.value=u+e,f.onChange(n.value),p=n.value,setTimeout(function(){n.focus()},0)},i.appendChild(r),e.appendChild(i);var p,f={onArrowDown:function(){},onArrowUp:function(){},onEnter:function(){},onTab:function(){},onChange:function(){f.repaint()},startFrom:0,options:[],wrapper:i,input:n,hint:o,dropDown:r,prompt:a,setText:function(e){o.value=e,n.value=e},getText:function(){return n.value},hideDropDown:function(){d.hide()},repaint:function(){var e=n.value,t=f.startFrom,i=f.options,a=i.length,l=e.substring(t);u=e.substring(0,t),o.value="";for(var s=0;s<a;s++){var c=i[s];if(0===c.indexOf(l)){o.value=u+c;break}}r.style.left=v(u)+"px",d.refresh(l,f.options)}},h=function(e,t){p=e.value;var n=function(){var n=e.value;p!==n&&(p=n,t(n))};e.addEventListener?(e.addEventListener("input",n,!1),e.addEventListener("keyup",n,!1),e.addEventListener("change",n,!1)):(e.attachEvent("oninput",n),e.attachEvent("onkeyup",n),e.attachEvent("onchange",n))};h(n,function(e){f.onChange(e)});var y=function(e){e=e||window.event;var t=e.keyCode;if(33!=t&&34!=t){if(27==t)return d.hide(),o.value=n.value,void n.focus();if(39!=t&&35!=t&&9!=t)if(13!=t){if(40==t){var i=d.move(1);return""==i&&f.onArrowDown(),void(o.value=u+i)}if(38==t){i=d.move(-1);return""==i&&f.onArrowUp(),o.value=u+i,e.preventDefault(),void e.stopPropagation()}o.value=""}else if(0==o.value.length)f.onEnter();else{var a="hidden"==r.style.visibility;if(d.hide(),a)return o.value=n.value,n.focus(),void f.onEnter();n.value=o.value;l=p!=n.value;p=n.value,l&&f.onChange(n.value)}else if(9==t&&(e.preventDefault(),e.stopPropagation(),0==o.value.length&&f.onTab()),o.value.length>0){d.hide(),n.value=o.value;var l=p!=n.value;p=n.value,l&&f.onChange(n.value)}}};return n.addEventListener?n.addEventListener("keydown",y,!1):n.attachEvent("onkeydown",y),f}n("3b2b");var y=n("a4bb"),b=n.n(y);function g(e,t){var n=[];for(var o in n.push({id:"",options:["always"].concat(Object(f["a"])(b()(t).map(function(t){return e+" "+t+" "})))}),n.push({id:"always",options:["."]}),n.push({id:e+" ",options:b()(t).map(function(e){return e+" "})}),t)for(var i in n.push({id:[e,o].join(" ")+" ",options:b()(t[o]).map(function(e){return e}),value:[m(o)]}),t[o])n.push({id:[e,o,i].join(" ")+"",options:t[o][i],value:[m(o),m(i)]});return n.reverse()}function m(e){e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",n="aaaaeeeeiiiioooouuuunc______",o=0,i=t.length;o<i;o++)e=e.replace(new RegExp(t.charAt(o),"g"),n.charAt(o));return e=e.replace(".","_").replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"_").replace(/-+/g,"_"),e}function w(e,t,n,o,i){var a=new FormData;return a.append("action",t),a.append("security",n),a.append(o,i),fetch(e,{method:"POST",body:a,credentials:"same-origin"})}var C={name:"udesly-autocomplete",props:["predicate","subjects","value","combination","first","enabled"],data:function(){return{valid:!1}},mounted:function(){var e=h(this.$el.querySelector("[udesly-completely]"),{fontFamily:"Roboto"}),t=this.predicate,n=this.subjects,o=g(t,n),i=this;e.onChange=function(n){if(i.valid=!1,i.$emit("validity-change",!1),i.$emit("input",[]),n.includes("always"))return i.valid=!0,i.$emit("validity-change",!0),void i.$emit("input",["always"]);console.log(n);for(var a=0;a<o.length;a++)if(n.includes(o[a].id)&&console.log(!0,o[a].id),n.includes(o[a].id)){if(e.startFrom=o[a].id.length,e.options=o[a].options,"."==o[a].options[0]?(console.log(o[a].value),console.log(a),i.$emit("input",o[a].value),i.valid=!0,i.$emit("validity-change",!0)):(i.valid=!1,i.$emit("validity-change",!1)),o[a].value){var l=t+" "+o[a].value.join(" ").replace(/_/g," ")+" ";console.log(l);var r=n.replace(l,"");console.log(r),console.log(o[a].value),2!=o[a].value.length||r.includes(t)||""==r||r.includes("{")||(i.valid=!0,i.$emit("validity-change",!0),i.$emit("input",[].concat(Object(f["a"])(o[a].value),[r])))}else i.valid=!1,i.$emit("validity-change",!1);return void e.repaint()}},e.options=o[o.length-1].options,setTimeout(function(){e.input.onfocus=function(){i.$el.classList.add("focused")},e.input.onfocusout=function(){i.$el.classList.remove("focused")},i.value.length&&e.setText(i.predicate+" "+i.value.join(" ")),e.repaint(),e.input.dispatchEvent(new Event("change"))},0)}},_=C,x=(n("1d6c"),n("2877")),k=Object(x["a"])(_,v,p,!1,null,null,null),L=k.exports,E=window.udeslyRules,j=E.nonce,S=E.ajaxurl,O=E.post_id,$=E.predicate,T=E.subjects,D=E.saveLabels,A=E.data;console.log(A);var H=[];if(A.values.length){var F=!0,M=!1,z=void 0;try{for(var P,R=d()(A.values);!(F=(P=R.next()).done);F=!0){var B=P.value;B.length&&H.push(B.map(function(e){return e.replace(/_/gm," ")}))}}catch(W){M=!0,z=W}finally{try{F||null==R.return||R.return()}finally{if(M)throw z}}}else H.push([]);var I={};A.combinations.length&&A.combinations.forEach(function(e,t){return I[t]=e});var V=o["a"].extend({name:"app",data:function(){return{predicate:$,subjects:T,values:H,combinations:I,enabledAdd:!0,saveLabels:D,status:"idle",buttonLabel:D["idle"],valids:{}}},watch:{values:function(e){var t=!0,n=!1,o=void 0;try{for(var i,a=d()(e);!(t=(i=a.next()).done);t=!0){var l=i.value;if(l.includes("always"))return void(this.enabledAdd=!1)}}catch(W){n=!0,o=W}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}this.enabledAdd=!0}},components:{AutoComplete:L},methods:{handleAnd:function(e){this.combinations[e]="and",this.values.push([])},handleOr:function(e){this.combinations[e]="or",this.values.push([])},handleRemove:function(e){this.values.splice(e,1),delete this.combinations[e]},handleValidityChange:function(e,t){this.valids[e]=t},isValid:function(){var e=u()(this.valids);return!e.includes(!1)&&0!=e.length},save:function(){var e=this;e.status="load",e.buttonLabel=e.saveLabels[e.status],w(S,"udesly_save_rule_content",j,"args",r()({values:e.values,combinations:e.combinations,post_id:O})).then(function(t){t.ok?(e.status="success",e.buttonLabel=e.saveLabels[e.status]):(e.status="fail",e.buttonLabel=e.saveLabels[e.status])}).finally(function(){setTimeout(function(){e.status="idle",e.buttonLabel=e.saveLabels[e.status]},2e3)})}}}),N=V,Z=(n("5c0b"),Object(x["a"])(N,i,a,!1,null,null,null)),q=Z.exports,J=n("2f62");o["a"].use(J["a"]);var U=new J["a"].Store({state:{},mutations:{},actions:{}});o["a"].config.productionTip=!1,new o["a"]({store:U,render:function(e){return e(q)}}).$mount("#udesly-rules")}});
//# sourceMappingURL=app.43f562ff.js.map