/*!
* WP Grid Builder Plugin
*
* @package   WP Grid Builder
* @author    Loïc Blascos
* @link      https://www.wpgridbuilder.com
* @copyright 2019-2021 Loïc Blascos
*
*/
!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}(),function(se){se(function(){"use strict";var e=window.navigator.userAgent,t=e.indexOf("MSIE");0<(t=(t=t<0?e.indexOf("Trident/"):t)<0?e.indexOf("Edge/"):t)&&se("html").addClass("is-ie");function n(e){var t=document.createElement("input");t.style.position="absolute",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}var i,e=function(i,o,a){var r;return function(){var e=this,t=arguments,n=a&&!r;clearTimeout(r),r=setTimeout(function(){r=null,a||i.apply(e,t)},o),n&&i.apply(e,t)}};se(document).on("click",".wpgb-copy-to-clipboard",function(){var e=se(this);clearTimeout(i),n(e.text().trim()),WPGB_Popup_Message("shortcode","success"),se(".wpgb-shortcode-copied").removeClass("wpgb-shortcode-copied"),e.addClass("wpgb-shortcode-copied"),i=setTimeout(function(){e.removeClass("wpgb-shortcode-copied")},1800)}),se('input[name="wpgb[shortcode]"][disabled]').parent().on("click",function(e){e.target&&"INPUT"===e.target.tagName&&parseInt(se('[name="wpgb_id"]').val(),10)&&(clearTimeout(i),n(e.target.value.trim()),WPGB_Popup_Message("shortcode","success"))});function o(e){var t=new Date;t.setTime(t.getTime()-1),document.cookie=e+"=; expires="+t.toGMTString()}function a(e){for(var t,n=decodeURIComponent(window.location.search.substring(1)).split("&"),i=0;i<n.length;i++)if((t=n[i].split("="))[0]===e)return"undefined"===t[1]||t[1]}se(document).on("submit","#wpgb form",function(){return!1});se(document).on("change",".wpgb-select-item",function(){var e,t=se(this),n=se(".wpgb-select-item:not(#wpgb-bulk-select)");t.is("#wpgb-bulk-select")?(e=t.prop("checked"),n.prop("checked",e)):(t=n.length,e=n.serializeArray().length,se("#wpgb-bulk-select").prop("checked",t===e))}),se("#wpgb_form").submit(function(e){e.preventDefault()});function r(t,e,n){e=se.extend({},t,e),c&&JSON.stringify(t)===JSON.stringify(s)&&c.abort(),s=t,c=se.ajax({url:ajaxurl,type:"POST",data:e,dataType:"json",beforeSend:function(e){n&&n.hasOwnProperty("before")&&n.before&&n.before(e),WPGB_Popup_Message(t.method,"loading")},error:function(e,t){"abort"!==t&&(n&&n.hasOwnProperty("error")&&n.error&&(e.success=!1,n.error(e)),WPGB_Popup_Message("unknown","error"),console.error(e))},success:function(e){n&&n.hasOwnProperty("success")&&n.success&&n.success(e),WPGB_Popup_Message(t.method,e.success?"success":"error",e.message)}})}var s,c=null;se(document).on("keyup",".wpgb-import-list-search input",function(){var t=0,e=se(".wpgb-list-item:not([hidden])"),n=se(".wpgb-import-list-number"),i=se(this).val();e.each(function(){var e=se(this);0<=e.find("span").text().toLowerCase().indexOf(i)?(t++,e.show()):e.hide()}),se(".wpgb-list-no-result")[0===t?"show":"hide"](),n.text(t+" "+n.data(1<t?"plural":"singular"))});var p=se(".wpgb-uploader"),d=se(".wpgb-uploader-message"),l=se(".wpgb-uploader-remove"),g=se(".wpgb-uploader-message").text();l.on("click",function(){se(".wpgb-import-list").remove(),l.attr("tabindex","-1"),b.removeAttr("tabindex")});function u(e){var t,n,i;e&&(t=new FormData,n=encodeURIComponent(a("username")),i=encodeURIComponent(a("password")),t.append("import",e),t.append("action","wpgb_import"),t.append("nonce",se("#wpgb_upload_field").val()),t.append("method","read_file"),t.append("object","upload"),t.append("wpgb","read_file"),t.append("auth",window.btoa(n+":"+i)),d.text(wpgb_popup_L10n.read_file),se(".wpgb-import-list").remove(),se.ajax({url:ajaxurl,type:"POST",contentType:!1,processData:!1,dataType:"json",data:t,context:se(this),success:function(e){e.content?(p.prepend(e.content.list),m=e.content.data,d.text(g),b.attr("tabindex","-1"),l.removeAttr("tabindex")):(d.text(e.message),setTimeout(function(){d.text(g)},2e3))},error:function(e,t){"abort"!==t&&(d.text(wpgb_popup_L10n.unknown),setTimeout(function(){d.text(g)},2e3),console.error(e))}}))}p.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}),p.on("dragover dragenter",function(){p.addClass("wpgb-is-dragover")}),p.on("dragleave dragend drop",function(){p.removeClass("wpgb-is-dragover")}),p.on("drop",function(e){e=e.originalEvent.dataTransfer.files;e[0]&&(se(".wpgb-import-list").remove(),u(e[0]))});var b=se(".wpgb-file-input");b.change(function(){var e=b[0].files[0];e&&(u(e),se(this).val(""))}),se(document).on("click",".wpgb-import-items",function(){var e,t=se(".wpgb-import-list input").WPGB_SerializeForm();Object.keys(t).length?(t=JSON.stringify(t),e=se(".wpgb-dashboard-page").length,t={data:m,demo:se(this).data("demo"),types:t},N(),r({nonce:se(this).data("nonce"),action:"wpgb_import",method:"import",object:"content",symbol:""},t,{before:"",success:e?"":q,error:e?"":q})):WPGB_Popup_Message("no_selection","error")});var w,m="";se(".wpgb-browse-demo").on("click",function(){var e=se(this);se(".wpgb-import-list").remove(),d.text(wpgb_popup_L10n.read_file),r({nonce:se("#wpgb_upload_field").val(),action:"wpgb_import",method:"browse_demo",object:"upload",symbol:""},{demo:e.data("demo")},{success:function(e){e.content?(m=e.content.data,p.prepend(e.content.list),d.text(g),b.attr("tabindex","-1"),l.removeAttr("tabindex")):(d.text(e.message),setTimeout(function(){d.text(g)},2e3))},error:function(e,t){"abort"!==t&&(d.text(wpgb_popup_L10n.unknown),setTimeout(function(){d.text(g)},2e3),console.error(e))}})});function _(e,t){window.clearInterval(w),o("wpgb_items_exported"),e={action:"wpgb_export",page:a("page"),type:e,nonce:wpgb_L10n.export,ids:t},(t=document.createElement("a")).href="admin-post.php?"+se.param(e),document.body.appendChild(t),t.click(),document.body.removeChild(t);var n=(new Date).getTime();w=window.setInterval(function(){var e=(new Date).getTime()-n,t=function(e){e=("; "+document.cookie).split("; "+e+"=");if(2==e.length)return e.pop().split(";").shift()}("wpgb_items_exported");(t||3e3<=e)&&(t=void 0!==t&&"false"!==t?decodeURIComponent(t).replace(/\+/g," "):"",WPGB_Popup_Message(null,"success",t),window.clearInterval(w),o("wpgb_items_exported"))},50)}se(document).on("click",".wpgb-bulk-export button",function(){var e=se(this).prev().find("select").val();e?(WPGB_Popup_Message("processing","loading"),setTimeout(function(){_(e,-1)},10)):WPGB_Popup_Message("no_content","error")});var f="";se(document).on("submit",".wpgb-dashboard-page form",function(e){e.preventDefault(),se('[data-method="activate_plugin"]').click()}),se(document).on("click",".wpgb-input-submit-wrapper",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),se(this).closest("form").submit()}),se(document).on("click",'[data-method="activate_plugin"], [data-method="deactivate_plugin"], [data-method="refresh_status"]',function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var t=se(this).data("method"),n=t.replace("_plugin","").replace("_status",""),i=se("#wpgb_plugin_"+n+"_field").val()||se(this).data("nonce"),e={page:window.location.href,license_email:se('input[name="license_email"]').val(),license_key:se('input[name="license_key"]').val()};f=se(this).closest(".wpgb-admin-panel"),r({nonce:i,action:"wpgb_plugin",method:t,object:n,symbol:""},e,{success:h,error:""})});function v(e){var t;e.content&&(t=y&&y[0]&&document.activeElement===y[0],se(".wpgb-admin-panel").replaceWith(e.content),t&&se(".wpgb-admin-panel").find('[data-slug="'+y.data("slug")+'"]').focus())}var h=function(e){!e.success&&se("#wpgb-license-email").length||e.content&&f.html(e.content)},y="";se(document).on("click",".wpgb-add-ons-card button",function(e){e.preventDefault();var t=y=se(this),n=t.data("method")+"_addon",i=n,o=t.data("name").replace(/^\s+|\s+$/g,"").toLowerCase().replace(".","-").replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/\//g,""),a=t.data("nonce"),e={slug:t.data("slug"),name:t.data("name")};t.text(wpgb_popup_L10n["install"===t.data("method")?"installing":"activating"]),t.addClass("wpgb-loading"),r({nonce:a,action:"wpgb_plugin",method:n,object:i,symbol:o},e,{success:v,error:v})}),se(document).on("click",".wpgb_global_settings_form .wpgb-settings-header button",function(e){e.preventDefault();var t=se(this).data("action");WPGB_Dialog(wpgb_dialog_L10n[t],function(){var e;"export"===t?(WPGB_Popup_Message("processing","loading"),setTimeout(function(){_("settings",-1)},10)):("save"===t?WPGB_Popup_Message("save_changes","loading"):WPGB_Popup_Message("reset_settings","loading"),e=se("form#wpgb_form").WPGB_SerializeForm().wpgb,r({nonce:se("#wpgb_fields_nonce").val(),action:"wpgb_global",method:t,object:"settings",symbol:""},{type:"settings",settings:JSON.stringify(e)},{success:x,error:null}))})});function P(){k.addClass("wpgb-loading"),r({nonce:se('[data-action="clear_index"]').data("nonce"),action:"wpgb_global",method:"index_stats",object:"settings",symbol:"clear_index"},null,{success:function(e){k.removeClass("wpgb-loading"),k.html(e.content)},error:null})}var x=function(e){var t;e.content&&(t=se('[aria-selected="true"]').index(),se("form#wpgb_form").replaceWith(e.content),se(".wpgb-settings-tabs ul li").eq(t).trigger("click"),se.WPGB_Conditional_Logic(),WPGB_Tooltip_Init(),WPGB_Select_Init(),WPGB_Gradient_Init())},k=se(".wpgb-index-stats"),W=k.html();k.length&&P(),se(document).on("click",'[data-action="clear_cache"], [data-action="delete_stylesheets"], [data-action="stop_indexer"], [data-action="clear_index"]',function(e){e.preventDefault();var t=se(this).data("action");r({nonce:se(this).data("nonce"),action:"wpgb_global",method:t,object:"settings",symbol:t},null,{success:function(){"clear_index"===t&&(k.html(W),P())},error:null})}),se(document).on("click",'.wpgb_grid_settings_form [data-action="save"]',function(e){e.preventDefault(),WPGB_Popup_Message("save_changes","loading");var t,n=se("form#wpgb_form").WPGB_SerializeForm().wpgb;for(t in n.grid_layout){var i,o=n.grid_layout[t].style,a=n.grid_layout[t].facets;for(i in o)""===o[i]&&delete o[i];Object.keys(o).length||a||delete n.grid_layout[t]}n={name:n.name,type:n.type,source:n.source,settings:n},r({nonce:se("#wpgb_fields_nonce").val(),action:"wpgb_grid",method:"save",object:"settings",symbol:""},{type:"grids",id:se('[name="wpgb_id"]').val(),settings:JSON.stringify(n)},{success:function(e){var t;e.success||e.message?(WPGB_Popup_Message("save_changes",e.success?"success":"error",e.message),window.history&&window.history.pushState&&e.content&&(t=WPGB_Query_String.set({create:"",id:e.content}),window.history.replaceState({},"",t),se('[name="wpgb_id"]').val(e.content),se('[name="wpgb[id]"]').val("wpgb-grid-"+e.content),se('[name="wpgb[shortcode]"]').val('[wpgb_grid id="'+e.content+'"]'))):WPGB_Popup_Message("unknown","error")},error:null})});var t=se('[name="wpgb[slug]"]'),G=!(!t||!t[0]||""!==t[0].value);se(document).on("input",'[name="wpgb[name]"]',function(e){var t=se('[name="wpgb[slug]"]')[0],n=this.value;G&&(t.value=B(n))}),se(document).on("change",'[name="wpgb[slug]"]',function(e){var t=this.value.trim();G=!t||(this.value=B(t),!1)});var B=function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")).replace(/(<([^>]+)>)/gi,"")).replace(/</g,"")).replace(/>/g,"")).replace(/%/g,"")).toLowerCase()).replace(/&.+?;/g,"",e)).replace(".","_",e)).replace(/[^%a-z0-9 _-]/g,"",e)).replace(/\s+/g,"_",e)).replace(/-\s*$/,"")).replace("-","_")};se(document).on("click",'.wpgb_facet_settings_form [data-action="save"]',function(e){e.preventDefault(),se('[name="wpgb[name]"]').trigger("input"),WPGB_Popup_Message("save_changes","loading");var n={slug:(n=se("form#wpgb_form").WPGB_SerializeForm().wpgb).slug,name:n.name,type:n.type,source:n.source,settings:n};r({nonce:se("#wpgb_fields_nonce").val(),action:"wpgb_facet",method:"save",object:"settings",symbol:""},{type:"facets",id:se('[name="wpgb_id"]').val(),settings:JSON.stringify(n)},{success:function(e){var t;e&&(e.success||e.message)?(WPGB_Popup_Message("save_changes",e.success?"success":"error",e.message),window.history&&window.history.pushState&&e.content&&(t=WPGB_Query_String.set({create:"",id:e.content.id}),window.history.replaceState({},"",t),se('[name="wpgb_id"]').val(e.content.id),se('[name="wpgb[id]"]').val("wpgb-facet-"+e.content.id),se('[name="wpgb[shortcode]"]').val('[wpgb_facet id="'+e.content.id+'" grid="0"]'),"string"==typeof e.content.index?O(e.content.index,n.slug):e.content.index&&I(e.content.id))):WPGB_Popup_Message("unknown","error")},error:null})});var C,S=se('button[data-action="index"], button[data-action="index_all"]'),j=se("title"),T=S.html(),L=j.html();se('button[data-action="index"]').on("click",function(){var e=se('[name="wpgb_id"]').val();e&&I(e)}),se('button[data-action="index_all"]').on("click",function(){I(-1)});function M(e){r({nonce:wpgb_L10n.index,action:"wpgb_index",method:"get_progress",object:"facets",symbol:""},{id:e},{success:function(e){var t;clearTimeout(C),e.content.message?(t=e.content.progress,e=e.content.message,t=parseFloat(t).toFixed(1),S.addClass("wpgb-indexing"),S.html(e),j.html(e),S.css("background-size",t+"% 100%")):(T!==S.html()&&(S.removeClass("wpgb-indexing"),S.css("background-size",""),S.html(wpgb_popup_L10n.indexing_complete),j.html(wpgb_popup_L10n.indexing_complete)),C=setTimeout(function(){S.html(T),j.html(L)},2500),clearInterval(E))},error:function(e){}})}var E,O=function(e,t){r({nonce:wpgb_L10n.index,action:"wpgb_index",method:"update_slug",object:"facets",symbol:""},{old_slug:e,new_slug:t},{success:function(e){},error:function(e){}})},D=0,I=function(t){0<D&&Date.now()-D<750||(D=Date.now(),S.addClass("wpgb-indexing"),S.css("background-size",""),S.html(-1===t?wpgb_popup_L10n.indexing_start:wpgb_popup_L10n.check_index),r({nonce:wpgb_L10n.index,action:"wpgb_index",method:"index",object:"facets",symbol:""},{id:t},{success:function(e){e.content||-1===t?(S.html(wpgb_popup_L10n.indexing_start),j.html(wpgb_popup_L10n.indexing_start)):(S.html(wpgb_popup_L10n.pending_index),j.html(wpgb_popup_L10n.pending_index)),clearInterval(E),z(t)},error:function(e){}}))},z=function(e){M(e),E=setInterval(function(){M(e)},2e3)};se('button[data-action="index_all"]').length&&z(-1);var A={},N=function(e,t){A={paged:1,s:se(".wpgb-list-table-search input").val()||"",order:se(".wpgb-sorting-active").data("order")||"DESC",orderby:se(".wpgb-sorting-active").data("orderby")||"modified_date",limit:se(".wpgb-list-table-per-page").val()||10,type:se(".wpgb-list-table-header").data("type")}};N(),se(document).on("click",".wpgb-list-table-indicators [data-orderby]:not(.wpgb-sorting-active)",function(){A.paged=1,A.order=se(this).data("order"),A.orderby=se(this).data("orderby"),$()}),se(document).on("click",".wpgb-list-table-page[data-page]:not(.wpgb-list-table-current-page)",function(){se(this).data("page")&&(A.paged=se(this).data("page"),$())}),se(document).on("change",".wpgb-list-table-per-page",function(){var e=se(this).val();e!==A.limit&&(A.paged=1,A.limit=e,$())}),se(document).on("keyup",".wpgb-list-table-search input",e(function(){var e=A.s.trim();A.paged=1,A.s=se(this).val().trim(),e!==A.s&&$()},200)),se(document).on("click",".wpgb-list-table-wrapper [data-action]",function(){U(se(this).data("nonce"),se(this).data("action"),se(this).closest("[data-id]").data("id"))}),se(document).on("click",".wpgb-list-table-bulk-actions button",function(){var e=se("input.wpgb-select-item:checked:not(#wpgb-bulk-select)").map(function(){return se(this).val()}).get();U(se("#wpgb_actions_nonce").val(),se(this).prev().find("select").val(),K||e)});function F(){ee(JSON.stringify({paged:1,order:"DESC",orderby:"modified_date",limit:100,type:"cards",s:se("#wpgb-search-card").val(),is_selector:1}),"overview"),se(".wpgb-grid-preview-header ul").hide(),se(".wpgb-grid-preview-header .wpgb-grid-preview-update").hide(),se(".wpgb-grid-preview-header .wpgb-search-field").show(),se(".wpgb-grid-preview-header .wpgb-search-field input").focus()}var J,U=function(e,t,n){t?"preview"!==t?!n||n.length<1?WPGB_Popup_Message("no_selection","error"):(A.ids=n,A.paged=1,WPGB_Dialog(wpgb_dialog_L10n[t],function(){WPGB_Popup_Message("processing","loading"),"export"===t?setTimeout(function(){_(A.type,n)},10):se.ajax({url:ajaxurl+"?"+se.param(A),type:"POST",data:{nonce:e,action:"wpgb_actions",method:t,object:se(".wpgb-list-table-header").data("type"),symbol:Array.isArray(n)?"bulk":t+"_"+n,type:A.type,ids:n},dataType:"json",beforeSend:function(e){Q(t,n),WPGB_Popup_Message(t,"loading")},error:function(e,t){"abort"!==t&&(q(e),WPGB_Popup_Message("unknown","error"),console.error(e))},success:function(e){q(e),WPGB_Popup_Message(t,e.success?"success":"error",e.message)}})})):ee(X=n,"grid"):WPGB_Popup_Message("no_action","error")},Q=function(e,t){if(t){Array.isArray(t)||(t=String(t).split());var n="",i=se(".wpgb-list-table-rows");switch(e){case"delete":n="wpgb-delete-item";break;case"duplicate":n="wpgb-duplicate-item";break;case"favorite":n="wpgb-favorite-item"}se('iframe[name="wpgb_preview"]').length&&(i=se('iframe[name="wpgb_preview"]').contents()),t.forEach(function(e){i.find('[data-id="'+e+'"]').addClass(n)})}},R="",q=function(e){var t,n,i;se(".wpgb-list-table-rows").removeClass("wpgb-loading"),se(".wpgb-list-table-rows li").removeClass("wpgb-delete-item wpgb-duplicate-item wpgb-favorite-item"),e.success&&(t=se("#wpgb-admin-content"),n=se(".wpgb-list-table-wrapper"),i=se(e.content).find(".wpgb-list-table-wrapper").html(),!e.content||R===e.content&&!Z||i&&n.length?i&&(R!==i||Z)&&(n.html(i),R=i):(t.html(e.content),R=e.content),A.type=se(".wpgb-list-table-header").data("type"),WPGB_Tooltip_Init(),WPGB_Select_Init(),te())},$=function(e){se(".wpgb-list-table-rows").addClass("wpgb-loading");var t={nonce:se('input[name="wpgb_actions_nonce"]').val(),action:"wpgb_actions",method:"query",object:se(".wpgb-list-table-header").data("type"),symbol:"bulk",type:A.type};J&&J.abort(),J=se.ajax({url:ajaxurl+"?"+se.param(A),type:"POST",data:t,dataType:"json",beforeSend:function(e){Q(t.action),WPGB_Popup_Message(t.method,"loading")},error:function(e,t){"abort"!==t&&(q(e),WPGB_Popup_Message("unknown","error"),console.error(e))},success:function(e){q(e),WPGB_Popup_Message(t.method,e.success?"success":"error",e.message)}})},H=null;se("button.wpgb-select-card").on("click",function(){H=se(this),F()}),se(document).on("keyup","#wpgb-search-card",e(function(){se(".wpgb-grid-preview-inner iframe").remove(),F()},200)),window.addEventListener("wpgb_preview_select_card.wpgb",function(e){var t,n=H.prev().find("select");n.find('option[value="'+e.detail.id+'"]').length||((t=document.createElement("option")).value=e.detail.id,t.text=e.detail.name,n[0].add(t,null)),se(".wpgb-grid-preview-close").click(),n.val(e.detail.id).trigger("change")}),se(document).on("change",'[name="wpgb[type]"], select[name*="wpgb[cards]"]',function(){Y()});var K,V,X,Y=function(){var e=se('[name="wpgb[type]"]:checked').val(),t=se('select[name*="wpgb[cards]"]').map(function(){return this.value}).get().filter(function(e,t,n){return""!==e&&t===n.indexOf(e)});r({nonce:se("#wpgb_fields_nonce").val(),action:"wpgb_grid",method:"check_type",object:"settings",symbol:""},{type:e,cards:t.length?t:[0]},{before:function(){},success:function(e){se(".wpgb-nota-grid-type.wpgb-warning").remove(),e.content&&(se("#wpgb-cards-tab > .wpgb-admin-section:nth-child(1)").append(e.content),se('[name="wpgb[type]"').closest(".wpgb-admin-section").append(e.content))}})};se('select[name*="wpgb[cards]"]').length&&Y();var Z=se(".wpgb-cards-page").length,ee=function(e,t){var n={action:"wpgb_preview",method:"preview",nonce:wpgb_L10n.preview,type:t,settings:e},e=document.createElement("iframe");e.name="wpgb_preview",se(".wpgb-grid-preview-inner").append(e);var i,o=document.createElement("form");for(i in o.method="post",o.target="wpgb_preview",o.action=wpgb_L10n.preview_action,n){var a=document.createElement("input");a.setAttribute("name",i),a.setAttribute("value",n[i]),o.appendChild(a)}document.body.appendChild(o),o.submit(),o=document.body.removeChild(o),o=null,se('iframe[name="wpgb_preview"]').css("opacity",0),se(".wpgb-grid-preview-header").removeClass("wpgb-grid-preview-small"),se(".wpgb-grid-preview-holder").show(),se(".wpgb-list-table-cards").show(),se(".wpgb-preloader").show(),se(".wpgb-grid-preview-header ul").removeAttr("style"),se(".wpgb-grid-preview-header .wpgb-grid-preview-update").removeAttr("style"),se(".wpgb-grid-preview-header .wpgb-search-field").hide()},te=function(){if(Z&&se(".wpgb-list-table-cards .wpgb-grid-preview-inner").length)return se(".wpgb-list-table-noresult").length?(se(".wpgb-grid-preview-inner iframe").remove(),void se(".wpgb-list-table-cards").hide()):void ee(JSON.stringify(A),"overview")};te(),se(document).on("click",'.wpgb_grid_settings_form [data-action="preview"]',function(e){e.preventDefault();var t=se('[name="wpgb_id"]').val(),e=se("form#wpgb_form").WPGB_SerializeForm().wpgb;e.id=0<t?t:"preview",X=JSON.stringify(e),se('iframe[name="wpgb_preview"]').remove(),ee(X,"grid")}),se(document).on("click",".wpgb-grid-preview-close, .wpgb-grid-preview-overlay",function(){ae(),se(".wpgb-grid-preview-holder").hide(),se('iframe[name="wpgb_preview"]').css("opacity",0),se(".wpgb-grid-preview-header li").removeClass("wpgb-active"),se(".wpgb-grid-preview-header li:first-child").addClass("wpgb-active"),se(".wpgb-grid-preview-inner").css("maxWidth","1920px"),se('iframe[name="wpgb_preview"]').remove()}),se(document).on("click",".wpgb-grid-preview-update",function(){ae(),se('iframe[name="wpgb_preview"]').remove(),ee(X,"grid")}),se(document).on("click",".wpgb-grid-preview-header li",function(e){var t=se(this).index(),n=V?Object.keys(V):[1920,1200,980,768,480,320];n.sort(function(e,t){return t-e});t=Math.min(1920,n[t]);se(".wpgb-grid-preview-inner iframe")[0].style.transition="none",se(".wpgb-grid-preview-inner iframe")[0].style.opacity=0,se(".wpgb-grid-preview-header li").removeClass("wpgb-active"),se(".wpgb-grid-preview-header")[t<380?"addClass":"removeClass"]("wpgb-grid-preview-small"),se(".wpgb-grid-preview-inner").css("maxWidth",t+"px"),se(this).addClass("wpgb-active"),setTimeout(function(){requestAnimationFrame(function(){se(".wpgb-grid-preview-inner iframe")[0].style.transition="",se(".wpgb-grid-preview-inner iframe")[0].style.opacity=1})},150)}),se(document).on("change","#wpgb-bulk-select",function(){var e=new CustomEvent("wpgb_preview_select_all.wpgb",{detail:se(this).prop("checked")||""});window.dispatchEvent(e)});function ne(){var e;se(".wpgb-grid-preview-holder").length||(e=se('iframe[name="wpgb_preview"]')).height(e.contents().find("html").outerHeight(!0))}window.addEventListener("wpgb_preview_loaded.wpgb",function(e){V=e.detail?e.detail.cardSizes:null,se(".wpgb-preloader").hide(),se('iframe[name="wpgb_preview"]').css("opacity",1),se('iframe[name="wpgb_preview"]').on("load",function(){ne(),se(this).contents().on("click",function(){se('iframe[name="wpgb_preview"]')[0].contentWindow.focus()})})}),window.addEventListener("wpgb_preview_resized.wpgb",function(e){ne()}),window.addEventListener("wpgb_preview_select_item.wpgb",function(e){K=e.detail.ids,se("#wpgb-bulk-select").prop("checked",e.detail.total===e.detail.selected)}),window.addEventListener("wpgb_preview_edit_item.wpgb",function(e){"_blank"===e.detail.target?window.open(e.detail.url,"_blank").focus():window.location.href=e.detail.url}),window.addEventListener("wpgb_preview_action.wpgb",function(e){e.detail.action&&(se(window).focus(),"edit"===e.detail.action?re(e.detail.nonce,e.detail.type,e.detail.id):U(e.detail.nonce,e.detail.action,e.detail.id))});var ie=null,oe=null,ae=function(){se(".wpgb-grid-preview-holder").removeAttr("data-disabled"),se(".wpgb-card-settings-holder").remove()},re=function(e,t,n){n&&t&&(ie=n,oe=t,WPGB_Popup_Message("processing","loading"),r({nonce:e,action:"wpgb_fields",method:"render_fields",object:"edit",symbol:n},{id:n,type:t},{before:function(){ae()},success:function(e){e.content?((e=se(e.content)).find("#wpgb_fields_nonce").remove(),se(".wpgb-grid-preview-holder").attr("data-disabled",""),se(".wpgb-grid-preview-holder").append(e),WPGB_Select_Init(),WPGB_Tooltip_Init(),WPGB_Gradient_Init(),jQuery.WPGB_Conditional_Logic(),(e=e.find(".wpgb-gallery")).length&&e.sortable({items:"> li:not(:first-child)",placeholder:"wpgb-image",revert:0}).disableSelection()):WPGB_Popup_Message("unknown","error")}}))};se(document).on("click",".wpgb-card-settings-holder",function(e){e.target&&e.target.classList.contains("wpgb-card-settings-close")&&ae(),e.target&&e.target.classList.contains("wpgb-card-settings-holder")&&ae()}),se(document).on("click",".wpgb-card-settings-holder button:first-of-type",function(e){var t;ie&&(t=se('.wpgb-card-settings *:not([name="wpgb_fields_nonce"])').WPGB_SerializeForm().wpgb,WPGB_Popup_Message("processing","loading"),r({nonce:se(this).data("nonce"),action:"wpgb_fields",method:"save_fields",object:"save",symbol:ie},{id:ie,type:oe,meta:JSON.stringify(t)},{before:function(){},success:function(e){e.content||WPGB_Popup_Message("unknown","error")}}))}),se(document).on("click",'.wpgb-nota-bene a[href*="&tab=card-styles"]',function(e){e.preventDefault(),se(".wpgb-card-styles-tab").click()})})}(jQuery);