/*!
* WP Grid Builder Plugin
*
* @package   WP Grid Builder
* @author    Loïc Blascos
* @link      https://www.wpgridbuilder.com
* @copyright 2019-2021 Loïc Blascos
*
*/
!function(n){"use strict";n.WPGB_Conditional_Logic=function(e){function t(){for(var e=[],t=document.querySelectorAll('#wpgb input:not([type="range"]):not(.wp-color-picker):not(.wpgb-range-slider-value):not(.wpgb-color-picker-input), #wpgb select, #wpgb textarea'),n=document.querySelectorAll('#wpgb [class^="wpgb"][data-field-condition]'),a=0,i=t.length;a<i;a++){var r=t[a];if(r.name){var o=r.name.match(/wpgb\[(.*)\]/)?r.name.match(/wpgb\[(.*)\]/)[1].replace("][",""):r.name,l=e[o];if("checkbox"===r.type)c=r.checked?r.value:0;else if("radio"===r.type)c=r.checked?r.value:"";else if(r.multiple&&"SELECT"===r.tagName)for(var c=[],s=r.children,p=0,u=s.length;p<u;p++)s[p].selected&&s[p].value&&c.push(s[p].value);else c=r.value;c&&!r.multiple&&-1<r.name.indexOf("[]")?(e[o]||(e[o]=[]),e[o].push(c)):l&&!c||(e[o]=c)}}for(a=0,i=n.length;a<i;a++){var d,g=n[a];g.condition?d=g.condition:(d=g.getAttribute("data-field-condition"),g.condition=d,g.setAttribute("data-field-condition","")),d=JSON.parse(d),g.style.display=m(d,e)?"block":"none"}}var m=function(e,t){if("object"!=typeof e)return 0;var n,a=0,i=0;for(n in e)e.hasOwnProperty(n)&&"object"==typeof(n=e[n])&&(a+=(n.field?r:m)(n,t),i++);return a===i||"OR"===(e.relation||"").toUpperCase()&&0<a?1:0},r=function(e,t){var n=t[e.field],a=e.value;switch((e.compare||"").toUpperCase()){case"CONTAINS":return n&&a&&-1<n.toString().indexOf(a.toString());case"IN":return-1<a.indexOf(n);case"NOT IN":return a.indexOf(n)<0;case"==":return n==a;case"===":return n===a;case"!=":return n!=a;case"!==":return n!==a;case">":return a<n;case">=":return a<=n;case"<":return n<a;case"<=":return n<=a;default:return!1}};return t(),e&&n(document).on("change",'#wpgb input:not([type="range"]):not(.wp-color-picker):not(.wpgb-range-slider-value):not(.wpgb-color-picker-input), #wpgb select, #wpgb textarea',t),this}}(jQuery),function(s){"use strict";s.WPGB_Conditional_Logic(!0),window.addEventListener("wpgb_builder.render_field",function(){s.WPGB_Conditional_Logic()});function r(e){var t;"function"==typeof Event?(t=new Event("change",{bubbles:!0}),e.dispatchEvent(t)):document.createEvent?((t=document.createEvent("HTMLEvents")).initEvent("change",!0,!0),e.dispatchEvent(t)):((t=document.createEventObject()).eventType="change",e.fireEvent("on"+t.eventType,t))}s(document).on("click",".wpgb-settings-collapse",function(){var e=s(this).val();("wpgb_settings_collapsed"===e?s(".wpgb-settings").parent():s(".wpgb-builder-header")).toggleClass("wpgb-settings-collapsed"),document.cookie=e+"="+(s(this).prop("checked")?1:0)}),s(document).on("click",".wpgb-image:first-child",function(){var o=s(this),l=o.is("li"),c=wp.media({id:"wpgb-media-popup",frame:"select",library:{type:l?o.parent(".wpgb-gallery").data("mime-type"):"image"},multiple:!!l&&"add"});c.on("open",function(){var e=[],t=c.state().get("selection");o.closest(".wpgb-field-input").find("input").each(function(){e.push(s(this).val())});var n=wp.media.query({posts_per_page:-1,post__in:e});n.more().done(function(){t.add(n.models)})}).on("select",function(){var n,a,i,r=document.createDocumentFragment(),e=c.state().get("selection");o.closest(".wpgb-gallery").find("li").not(o).remove(),e.each(function(e,t){i=o,l&&e.id&&((i=o.clone(!0)).removeAttr("title"),i.removeAttr("mime-type"),i.find(".wpgb-plus-icon").remove(),i.find(".wpgb-image-filename").remove(),r.appendChild(i[0])),n=(n=e.get("sizes"))?n.medium||n.thumbnail||n.full:null,a=n?n.url:e.get("url"),"image"!==e.get("type")&&(a=(a=e.get("thumb"))?a.src:null,n=e.get("filename"),a=a||(!(a=e.get("icon"))||-1<a.indexOf("images/media/")?"":a),n&&i.append('<span class="wpgb-image-filename">'+n+"</span>")),i.find("input").val(e.id),i.find(".wpgb-image-background").css("background-image",a?"url("+a+")":"")}),s(r).insertAfter(o),c.detach(),c.dispose(),o.find("input").first().trigger("change")}).on("close",function(){c.detach(),c.dispose()}).open()}),s(document).on("click",".wpgb-image-delete",function(e){e.preventDefault(),e.stopPropagation();var t=s(this).closest(".wpgb-image");t.is("li")?(e=t.parent(),t.remove(),e.find("input").first().trigger("change")):(t.find("input").val("").trigger("change"),t.find(".wpgb-image-background").removeAttr("style"))});var o,e=s(".wpgb-gallery");e.length&&e.sortable({items:"> li:not(:first-child)",placeholder:"wpgb-image",revert:150}).disableSelection(),s(document).on("click",".wpgb-upload-media",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var t=s(this).prev("input"),n=wp.media({library:{type:s(this).data("mime-type")}}).on("select",function(){t.val(n.state().get("selection").first().get("url")),r(t[0]),n.detach(),n.dispose()}).on("close",function(){n.detach(),n.dispose()}).open()});function l(e,t,n){var a=parseFloat(e.value.replace(",","."));return n&&(""===a||null===a||isNaN(a))?"":(e=parseFloat(t.min||t.getAttribute("data-min"))||0,n=parseFloat(t.max||t.getAttribute("data-max"))||0,t=parseFloat(t.step)||1,t=Math.floor(t)!==t?t.toString().split(".")[1].length:0,a=isNaN(a)?0:parseFloat(a),a=Math.max(e,Math.min(n,a)),a=parseFloat(a.toFixed(t)))}function c(e,t){var n=JSON.parse(t.getAttribute("data-units"));if(!Array.isArray(n)||!n)return"";var a=n.filter(function(e){return e}),i=new RegExp(a.join("|"),"gi"),i=e.value.toString().match(i),i=a.length===n.length||i?i?i.shift():n[0]:"";return t.wpgb_unit=i,p(t,i,n),i}var p=function(e,t,n){n=n.indexOf(t)||0,t=JSON.parse(e.getAttribute("data-steps")),n=Array.isArray(t)?t[n]:1;e.step=n||1};s(document).on("focusout",".wpgb-number",function(e){e=e.target;e.value=l(e,e,!0)}),s(document).on("input",".wpgb-text-number",function(e){var i=e.target;clearTimeout(o),o=setTimeout(function(){var e=i.selectionEnd,t=i.value.length,n=c(i,i),a=l(i,i,!0);i.value=""!==a&&0!==a?a+n:a,i.selectionStart=i.selectionEnd=Math.max(0,e-Math.max(0,t-i.value.length)),r(i)},800)}),s(document).on("focusout",".wpgb-text-number",function(e){var t=e.target,n=c(t,t),e=l(t,t,!0);clearTimeout(o),t.value=""!==e&&0!==e?e+n:e,r(t)});function i(e){var t=e.min,n=e.max,t=50<(t=100*(e.value-t)/(n-t))?t-.2:t+.2;e.style.backgroundSize=(""!==e.nextSibling.value?Math.min(100,wpgb_L10n.RTL?100-t:t):0)+"% 100%"}s(document).on("input change","input.wpgb-range-slider",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var t=e.target,n=t.nextSibling,e=t.wpgb_unit||c(n,t);i(t),n.value=""===n.value&&0===parseFloat(t.value)?n.value:t.value+e,r(n)}),s(document).on("input",".wpgb-range-slider-value",function(e){var n=e.target,a=n.previousSibling;clearTimeout(o),a.value=l(n,a,!1),i(a),o=setTimeout(function(){var e=n.selectionEnd,t=n.value.length;c(n,a),a.value=l(n,a,!1),s(a).trigger("change"),n.selectionStart=n.selectionEnd=Math.max(0,e-Math.max(0,t-n.value.length))},1e3)}),s(document).on("focusout",".wpgb-range-slider-value",function(e){var t=e.target,e=t.previousSibling;clearTimeout(o),c(t,e),e.value=l(t,e,!1),s(e).trigger("change")});function t(){s(".wpgb-code").each(function(){var e,t=s(this);t.next(".CodeMirror").length||(t.closest("div").add(t).css({display:"block",width:"100%",height:t.data("height")+"px"}),e=CodeMirror.fromTextArea(t[0],{mode:t.data("mode"),value:t.val(),theme:"material",htmlMode:!0,matchClosing:!0,lineNumbers:!0,styleActiveLine:!0,matchBrackets:!0,nonEmpty:!1,indentWithTabs:!0,indentUnit:4,scrollbarStyle:"simple",direction:wpgb_L10n.RTL?"rtl":"ltr"}),s(e.display.wrapper).find("textarea").attr("aria-label","editor"),e.on("blur",function(e){t.val(e.getValue())}),e.on("change",function(e){t.val(e.getValue()),r(t[0])}))})}t(),window.addEventListener("wpgb_builder.render_field",function(e){t()}),s('select[name="wpgb[post_type][]"]').on("change",function(){n()});var n=function(){var e=s('select[name="wpgb[post_type][]"]').val();s('select[name="wpgb[tax_query][]"]').attr("data-post",e||["post"])};n(),s('select[name="wpgb[meta_key]"]').attr("data-post","key"),s(document).on("click",".wpgb-add-relation",function(e){e.preventDefault();e=0<(e=s(this).prev(".wpgb-meta-clauses")).length?e.clone():s(this).closest(".wpgb-meta-clauses");u(e.clone(),s(this))}),s(document).on("click",".wpgb-add-metakey",function(e){e.preventDefault(),u(s(this).prev().clone(),s(this))}),s(document).on("click",".wpgb-delete-metakey",function(e){e.preventDefault(),s(this).parent().remove(),g()});function a(){var e=s('[name="wpgb[type]"]:checked').val();s(".wpgb-table.wpgb-table-card-sizes [data-colname]:not(:first-child)").show(),s("justified"===e?'.wpgb-table.wpgb-table-card-sizes [data-colname="columns"]':'.wpgb-table.wpgb-table-card-sizes [data-colname="height"]').hide(),"masonry"!==e&&"justified"!==e||s('.wpgb-table.wpgb-table-card-sizes [data-colname="ratio"]').hide()}var u=function(e,t){e.find("input").val(""),e.find("select").each(function(){var e=s(this);e.val(e.find("option").first().val()),e.insertAfter(e.parent())}),e.find("label").each(function(){var e=s(this),t=e.next().find("input, select"),n="wpgb-"+Math.random().toString(36).substr(2,9);e.attr("for",n),t.attr("id",n)}),e.find(".wpgb-add-relation").remove(),e.find(".wpgb-meta-clauses").remove(),e.find(".wpgb-meta-clause").not(":eq(0), .wpgb-add-metakey").remove(),e.find(".wpgb-select-wrapper").remove(),e.insertBefore(t),WPGB_Select_Init(),g()},d=document.querySelector(".wpgb-meta-clauses"),g=function(e,t){t=t||[0];for(var n=0,a=(e=e||document.querySelector(".wpgb-meta-clauses")).children,i=0,r=a.length;i<r;i++){var o=a[i];!o.classList.contains("wpgb-meta-clause")||o.classList.contains("wpgb-add-metakey")?o.classList.contains("wpgb-meta-clauses")&&(d===e?t=[t[0]+1,0]:t.push(0),g(o,t)):(m(o,t,n),n++)}},m=function(e,t,n){var a=e.parentElement.querySelector('select[name*="relation"]'),i=a.name.match(/\[(.*?)\]/g),r=0<t.slice(0,-1).length?"["+t.slice(0,-1).join("][")+"]":"";a.name="wpgb[meta_query]"+r+i.pop(),t[t.length-1]=n;for(var o=e.querySelectorAll("input, select"),l=0,c=o.length;l<c;l++)i=(a=o[l]).name.match(/\[(.*?)\]/g),r=0<t.length?"["+t.join("][")+"]":"",a.name="wpgb[meta_query]"+r+i.pop();return t};s(document).on("change",'[name="wpgb[type]"]',function(){a()}),s('input[name="wpgb[card_sizes][0][browser]"]').prop("disabled",!0).val(9999),a(),s(".wpgb-layout-facets").length&&s(".wpgb-layout-facets").sortable({items:".wpgb-layout-facet",connectWith:".wpgb-layout-facets",appendTo:s("#wpgb"),helper:"clone",revert:150,start:function(e,t){t.item.show();var n=parseFloat(getComputedStyle(t.item[0]).width);t.helper.css("width",n),t.placeholder.css("width",n),t.item.hide()},receive:function(e,t){var n=t.item.find("input"),a=n.closest("ul");a.closest(".wpgb-available-facets").length?n.removeAttr("name"):n.attr("name","wpgb[grid_layout]["+a.data("area")+"][facets][]"),t.item.removeAttr("style"),b()}}).disableSelection();var b=function(){s(".wpgb-layout .wpgb-layout-facets").each(function(){var e=s(this).find("li");e.first()[1<e.length?"fadeOut":"fadeIn"](150)})};b(),s('.wpgb-layout-buttons [data-button="settings"]').on("click",function(e){var t=s(this).closest(".wpgb-layout-area").find("> .wpgb-layout-style");t.attr("style")?t.removeAttr("style"):(s(".wpgb-layout-style").removeAttr("style"),t.show())}),s(document).on("click",function(e){s(e.target).is('[data-button="settings"]')||s(e.target).closest(".wpgb-layout-style").length||s(e.target).closest(".wpgb-select-results").length||s(".wpgb-layout-style").removeAttr("style")}),s('.wpgb-layout-buttons [data-button^="flex-"], .wpgb-layout-buttons [data-button^="center"]').on("click",function(){var e=s(this),t=e.data("button").replace("text-",""),n=e.closest(".wpgb-layout-area");n.find(".wpgb-layout-facets").css("justify-content",t||""),n.find('[type="radio"][value="'+t+'"]').prop("checked",!0).trigger("change"),e.prevAll().add(e.nextAll()).removeClass("wpgb-layout-button-active"),e.addClass("wpgb-layout-button-active")});function f(){var e=h.val(),t=s('[name="wpgb[transition]"]').val(),n=s('[name="wpgb[timing_function]"]').val();e&&w.hasOwnProperty(e)&&(e=w[e]).hasOwnProperty("hidden")&&e.hasOwnProperty("visible")&&(e.hidden.transition="none",s(".wpgb-animation-placeholder").removeAttr("style"),s(".wpgb-animation-placeholder").css(e.hidden),clearTimeout(v),v=setTimeout(function(){"custom"===n&&(n=s('[name="wpgb[cubic_bezier_function]"]').val()),e.visible.transition="all "+parseInt(t)+"ms "+n,s(".wpgb-animation-placeholder").css(e.visible)},50))}var v,h=s('select[name="wpgb[animation]"]'),w=0<h.length?wpgb_animations_L10n:{};s('[name="wpgb[animation]"], [name="wpgb[transition]"], [name="wpgb[timing_function]"], [name="wpgb[cubic_bezier_function]"]').on("change",function(){f()}),s(".wpgb-run-animation").on("click",function(e){e.preventDefault(),f()});function y(e){A.css({color:e,borderColor:e,backgroundColor:e})}function _(e){k.css({transform:"scale("+parseFloat(e)+")"})}var k=s("."+s('[name="wpgb[loader_type]"]:checked').val()),A=k.find("div"),x=s('[name="wpgb[loader_color]"]'),e=s('[name="wpgb[loader_type]"]'),S=s('[name="wpgb[loader_size]"]');e.on("change",function(){k.removeAttr("style"),A.removeAttr("style"),k=s("."+s(this).val().trim()),A=k.find("div"),y(x.val()),_(S.val())}),S.on("change",function(){_(s(this).val())}),x.on("change",function(){y(s(this).val())}),y(x.val()),_(S.val());function E(e){e.find("tbody tr").each(function(n){s(this).find("td").each(function(){var e=s(this).find("input, select"),t="wpgb-"+Math.random().toString(36).substr(2,9);s(this).find("label").attr("for",t),e.each(function(){var e=s(this)[0].name;s(this)[0].name=e.replace(/\[(\d+)\]/g,"["+n+"]"),"hidden"!==s(this).attr("type")&&(s(this)[0].id=t)})})})}var C,e=s(".wpgb-repeater tbody");e.length&&(C=s("<tr>"),e.sortable({axis:"y",handle:".wpgb-repeater-sort",revert:150,start:function(e,t){t.placeholder&&t.placeholder.children().each(function(e,t){0!==e&&t.remove()})},sort:function(e,t){if(s(this).find("tr").length<3)return t.item.removeAttr("style"),t.item.removeAttr("class"),void t.placeholder.css("display","none");s(".wpgb-repeater-sort").addClass("wpgb-dragging"),C.insertAfter(t.item)},stop:function(e,t){s(".wpgb-repeater-sort").removeClass("wpgb-dragging"),C.remove(),E(s(this).closest(".wpgb-repeater"))}}).disableSelection()),s(document).on("click",".wpgb-add-row",function(e){e.preventDefault();var t=s(this).prev(".wpgb-table-wrapper").find(".wpgb-repeater"),n=t.find("tbody"),e=n.find("tr");e.length>=t.attr("data-limit")-1&&s(this).hide(),e.length>=t.attr("data-limit")||((e=e.first().clone()).find(".ui-sortable-handle").show(),e.find("input").val(""),e.find("select").each(function(){var e=s(this);e.val(e.find("option").first().val()),e.insertAfter(e.parent())}),e.find(".wpgb-select-wrapper").remove(),e.find(".wpgb-color-holder").remove(),e.find(".wpgb-color-picker-preview").removeAttr("style"),n.append(e),e.find(".wpgb-range-slider-value").trigger("input"),e.find("input.wpgb-range-slider").trigger("input"),WPGB_Select_Init(),WPGB_Gradient_Init(),E(t))}),s(document).on("click",".wpgb-delete-row",function(e){var t=s(this).closest(".wpgb-repeater"),n=t.find("tbody").find("tr").length,a=s(this).closest("tr");t.next(".wpgb-add-row").show(),n<2||(a.remove(),E(t))})}(jQuery);